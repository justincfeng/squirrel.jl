<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · squirrel.jl</title><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">squirrel.jl</a></span></div><form class="docs-search" action="search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href="index.html">Home</a><ul class="internal"><li><a class="tocitem" href="#Introduction"><span>Introduction</span></a></li><li><a class="tocitem" href="#Tutorial"><span>Tutorial</span></a></li></ul></li><li><a class="tocitem" href="metrics.html">Metrics</a></li><li><a class="tocitem" href="geodesics.html">Geodesic solver</a></li><li><a class="tocitem" href="squirrel.html">Squirrel algorithm</a></li><li><a class="tocitem" href="evaluation.html">Evaluation</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="index.html">Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/justincfeng/squirrel.jl/blob/master/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Home"><a class="docs-heading-anchor" href="#Home">Home</a><a id="Home-1"></a><a class="docs-heading-anchor-permalink" href="#Home" title="Permalink"></a></h1><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><p>Relativistic positioning refers to the concept of establishing spacetime positions from proper time broadcasts emitted by a system of satellites. Central to relativistic positioning is the relativistic location problem,  which is the problem of finding the intersection of future pointing light cones from a collection of at least four emission points. Algorithms for relativistic location in flat spacetime are provided in the <a href="https://github.com/justincfeng/cereal.jl/"><code>cereal.jl</code></a> package. This package, <code>squirrel.jl</code>, contains a collection of functions for the relativistic location problem in slightly curved spacetime geometries.</p><h2 id="Tutorial"><a class="docs-heading-anchor" href="#Tutorial">Tutorial</a><a id="Tutorial-1"></a><a class="docs-heading-anchor-permalink" href="#Tutorial" title="Permalink"></a></h2><h3 id="Setup"><a class="docs-heading-anchor" href="#Setup">Setup</a><a id="Setup-1"></a><a class="docs-heading-anchor-permalink" href="#Setup" title="Permalink"></a></h3><p>The <code>squirrel.jl</code> code was written and tested in Julia 1.6; we recommend Julia 1.6 or newer. In this tutorial, it is assumed that one can invoke Julia directly from the command line/terminal by typing the command <code>julia</code>, as is typically the case for installations on linux  distributions (Ubuntu and Manjaro for instance). For detailed  instructions on how to set this up, please refer to the <a href="https://julialang.org/downloads/platform/"><code>platform specific</code></a>  installation instructions for Julia.</p><p>To add <code>squirrel.jl</code>, first run the <code>julia</code> command in the  command line/terminal to open the Julia <code>REPL</code>. Next, open the package  manager by typing <code>]</code>. In the package manager, run the command to add <code>squirrel.jl</code>:</p><pre><code class="nohighlight hljs">pkg&gt; add https://github.com/justincfeng/squirrel.jl/</code></pre><p>The package manager can be exited by pressing the backspace key. Once  the added, one may access the functions contained in the <code>squirrel</code>  module with the following command:</p><pre><code class="nohighlight hljs">julia&gt; using squirrel</code></pre><h3 id="Positioning-examples"><a class="docs-heading-anchor" href="#Positioning-examples">Positioning examples</a><a id="Positioning-examples-1"></a><a class="docs-heading-anchor-permalink" href="#Positioning-examples" title="Permalink"></a></h3><h4 id="Vacuum-case"><a class="docs-heading-anchor" href="#Vacuum-case">Vacuum case</a><a id="Vacuum-case-1"></a><a class="docs-heading-anchor-permalink" href="#Vacuum-case" title="Permalink"></a></h4><p>One begins by defining a metric. The Kerr-Schild metric for a rotating object with the mass and angular momentum of the Earth is given by the following function:</p><pre><code class="nohighlight hljs">julia&gt; gks = squirrel.metric.ge</code></pre><p>The resulting function <code>gks</code> takes a four-component vector <code>xc=[t,x,y,z]</code> (representing spacetime coordinates) as an argument, and returns a <span>$4×4$</span> matrix of metric components. The units are normalized to Earth mass (1 length unit = 0.4435 cm), and chosen so that the speed of light is 1. One can randomly generate a target point <code>Xtar</code> and a set of <span>$5$</span> emission points <code>X</code> on the past light cone of <code>Xtar</code> with the following:</p><pre><code class="nohighlight hljs">julia&gt; (X,Xtar) = squirrel.seval.pgen(6e9,gks,1e-14,5) ;</code></pre><p>The first argument in the function on the left hand side specifies (roughly) the spatial radius of the emission points from the origin, and the third argument specified the tolerance for the geodesic integrator. The target point <code>Xtar</code> is placed on the WGS84 reference ellipsoid (defined with respect to the Cartesian Kerr-Schild coordinates).</p><p>The intersection of future light cones from the emission points is computed with the <code>squirrel.locator</code> function:</p><pre><code class="nohighlight hljs">julia&gt; Xs = squirrel.locator(X,gks,1e-10)</code></pre><p>The third argument is the tolerance for the geodesic solvers; the tolerance is looser here to minimize computation time. The accuracy of the result may be estimated by comparing <code>Xs</code> and <code>Xtar</code>:</p><pre><code class="nohighlight hljs">julia&gt; ΔX = Xs-Xtar</code></pre><p>Upon multiplying by the conversion factor 0.4435 to obtain the result in units of centimeters (<code>0.4435*ΔX</code>), one typically obtains a result well in the submillimeter range. The relative error may be obtained by running:</p><pre><code class="nohighlight hljs">julia&gt; squirrel.norm(ΔX)/squirrel.norm(Xtar)</code></pre><p>and one typically obtains errors on the order of <span>$\sim 10^{-11} - 10^{-13}$</span>.</p><h4 id="Including-atmospheric-and-ionospheric-effects"><a class="docs-heading-anchor" href="#Including-atmospheric-and-ionospheric-effects">Including atmospheric and ionospheric effects</a><a id="Including-atmospheric-and-ionospheric-effects-1"></a><a class="docs-heading-anchor-permalink" href="#Including-atmospheric-and-ionospheric-effects" title="Permalink"></a></h4><p>One can incorporate the effects of the atmosphere and ionosphere with the following metric:</p><pre><code class="nohighlight hljs">julia&gt; g = squirrel.metric.g</code></pre><p>This metric is the Gordon metric for light propagatation through media; here, a simple model for the atmosphere and ionosphere is implemented. One may repeat the steps of the vacuum case to obtain the errors:</p><pre><code class="nohighlight hljs">julia&gt; (Xn,Xntar) = squirrel.seval.pgen(6e9,g,1e-14,5) ;

julia&gt; Xns = squirrel.locator(Xn,g,1e-10)

julia&gt; ΔXn = Xns-Xntar

julia&gt; 0.4435*ΔXn

julia&gt; squirrel.norm(ΔXn)/squirrel.norm(Xntar)</code></pre><p>In this case, one typically finds that the errors are larger than the vacuum case by an order of magnitude, though still in the submillimeter range. </p><h3 id="Benchmarking"><a class="docs-heading-anchor" href="#Benchmarking">Benchmarking</a><a id="Benchmarking-1"></a><a class="docs-heading-anchor-permalink" href="#Benchmarking" title="Permalink"></a></h3><p>For benchmarking, it is best to start Julia with four threads enabled. This can be done by starting Julia from the command line/terminal with  the command (to exit the Julia REPL, run the command <code>julia&gt; exit()</code>):</p><pre><code class="nohighlight hljs">julia --threads 4</code></pre><p>The number of threads can be verified with the command:</p><pre><code class="nohighlight hljs">julia&gt; Threads.nthreads()</code></pre><p>To determine the execution time, one may use the package (<code>BenchmarkTools</code>](https://github.com/JuliaCI/BenchmarkTools.jl). Once installed, one first runs the command:</p><pre><code class="nohighlight hljs">julia&gt; using BenchmarkTools</code></pre><p>One should then run the following commands:</p><pre><code class="nohighlight hljs">julia&gt; using squirrel
julia&gt; gks = squirrel.metric.ge
julia&gt; g   = squirrel.metric.g
julia&gt; (X,Xtar)   = squirrel.seval.pgen(6e9,gks,1e-14,6) ;
julia&gt; (Xn,Xntar) = squirrel.seval.pgen(6e9,g,1e-14,6)   ;</code></pre><p>Julia employs Just-In-Time (JIT) compilation. Practically, this means that the first time a function is executed, additional time is required to compile the code. For this reason, it is recommended that the following functions are run first before performing execution time benchmarks:</p><pre><code class="nohighlight hljs">julia&gt; squirrel.locator(X,gks,1e-10) ;
julia&gt; squirrel.locator(Xn,g,1e-10)  ;</code></pre><p>The execution time may be determined by running the following commands:</p><pre><code class="nohighlight hljs">julia&gt; @btime squirrel.locator(Xn,gks,1e-10,4)
julia&gt; @btime squirrel.locator(Xn,gks,1e-10,5)
julia&gt; @btime squirrel.locator(Xn,gks,1e-10,6)

julia&gt; @btime squirrel.locator(X,g,1e-10,4)
julia&gt; @btime squirrel.locator(X,g,1e-10,5)
julia&gt; @btime squirrel.locator(X,g,1e-10,6)</code></pre><h3 id="Evaluation"><a class="docs-heading-anchor" href="#Evaluation">Evaluation</a><a id="Evaluation-1"></a><a class="docs-heading-anchor-permalink" href="#Evaluation" title="Permalink"></a></h3><p>It is recommended that the evaluation scripts are run with four threads; as indicated in the Benchmarks section, one can do this from the command line/terminal command <code>julia --threads 4</code>.</p><p>Scripts are provided for a more comprehensive evaluation of the accuracy and performance of the functions in <code>squirrel.jl</code>. To find the scripts directory, run the command:</p><pre><code class="nohighlight hljs">julia&gt; pathscript = dirname(dirname(pathof(squirrel)))*&quot;/scripts/&quot;</code></pre><p>which should return a string with the path to the scripts directory. Before running the scripts, one should make the following directory (this will throw an error if a directory already exists):</p><pre><code class="nohighlight hljs">julia&gt; mkdir(dirname(dirname(pathof(squirrel)))*&quot;/res/&quot;)</code></pre><p>To generate the samples, one should first change to the scripts directory</p><pre><code class="nohighlight hljs">julia&gt; cd(pathscript)</code></pre><p>and then run the <code>samplegen.jl</code> script (which may require installation of the <code>CoordinateTransformations</code> and <code>LegendrePolynomials</code> packages):</p><pre><code class="nohighlight hljs">julia&gt; include(&quot;samplegen.jl&quot;)</code></pre><p>This will generate 1000 samples. Once the samples have been generated, run the evaluation script:</p><pre><code class="nohighlight hljs">julia&gt; include(&quot;evaluation.jl&quot;)</code></pre><p>which will evaluate the locator functions in <code>squirrel.jl</code> for 1000 test cases, and for the terrestrial positioning problem in four geometries: the Kerr-Schild metric, the Gordon metric for an analogue Gordon metric modeling atmospheric and ionospheric effects and two perturbed Gordon metrics corresponding to fractional uncertainties of up <span>$1\%$</span>  to <span>$10\%$</span> in the ionospheric electron density (and a <span>$0.1\%$</span> uncertainty in the atmospheric index of refraction). </p><p>The results can be plotted with the scripts:</p><pre><code class="nohighlight hljs">julia&gt; include(&quot;plotresults.jl&quot;)</code></pre><p>The results are located in the following <code>res</code> directory:</p><pre><code class="nohighlight hljs">julia&gt; dirname(dirname(pathof(squirrel)))*&quot;/res/&quot;</code></pre><p>If one wishes to change the parameters of the sample generation and evaluation scripts (for instance, if one wishes to increase the number of test cases), one should make a copy of the repository, make changes to the files in the <code>scripts</code> folder of the repository (the parameters of the script <code>plotresults.jl</code> should be changed accordingly). One may then run the edited scripts in the <code>scripts</code> folder.</p></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="metrics.html">Metrics »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.10 on <span class="colophon-date" title="Wednesday 5 January 2022 17:11">Wednesday 5 January 2022</span>. Using Julia version 1.6.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
