<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Metrics · squirrel.jl</title><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">squirrel.jl</a></span></div><form class="docs-search" action="search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="index.html">Home</a></li><li class="is-active"><a class="tocitem" href="metrics.html">Metrics</a><ul class="internal"><li><a class="tocitem" href="#Kerr-Schild-metric"><span>Kerr-Schild metric</span></a></li><li><a class="tocitem" href="#Weak-field-metric"><span>Weak field metric</span></a></li><li><a class="tocitem" href="#Gordon-metric"><span>Gordon metric</span></a></li></ul></li><li><a class="tocitem" href="geodesics.html">Geodesic solver</a></li><li><a class="tocitem" href="squirrel.html">Squirrel algorithm</a></li><li><a class="tocitem" href="evaluation.html">Evaluation</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="metrics.html">Metrics</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="metrics.html">Metrics</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/justincfeng/squirrel.jl/blob/master/docs/src/metrics.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Metrics"><a class="docs-heading-anchor" href="#Metrics">Metrics</a><a id="Metrics-1"></a><a class="docs-heading-anchor-permalink" href="#Metrics" title="Permalink"></a></h1><h2 id="Kerr-Schild-metric"><a class="docs-heading-anchor" href="#Kerr-Schild-metric">Kerr-Schild metric</a><a id="Kerr-Schild-metric-1"></a><a class="docs-heading-anchor-permalink" href="#Kerr-Schild-metric" title="Permalink"></a></h2><p>The Kerr-Schild metric takes the form:</p><p class="math-container">\[    g_{\mu \nu} = \eta_{\mu \nu} + f \, k_\mu \, k_\nu \]</p><p>where </p><p class="math-container">\[  k_\mu = \left( 1 , \frac{r \, x + a \, y}{r^2+a^2}
                , \frac{r \, y - a \, x}{r^2+a^2} , \frac{z}{r}\right)\]</p><p class="math-container">\[  f = \frac{2 \, G \, M \, r^3}{r^4+a^2 \, z^2},\]</p><p>and <span>$r$</span> is implicitly defined by:</p><p class="math-container">\[\frac{x^2+y^2}{r^2+a^2} + \frac{z^2}{r^2} = 1 .\]</p><p>The components of the Kerr-Schild metric can be calculated using <code>gks</code> function in general</p><article class="docstring"><header><a class="docstring-binding" id="squirrel.metric.gks" href="#squirrel.metric.gks"><code>squirrel.metric.gks</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">gks( X::RealVec , a::Real=0 , GM::Real=1 )</code></pre><p>The <code>gks</code> function takes a point <code>X</code> in Cartesian Kerr-Schild  coordinates and calculates the components of the Kerr-Schild metric at  that point in a Kerr spacetime with rotation parameter <code>a</code> and with the  product of gravitational constant and mass <code>GM</code></p></div></section></article><p>or using the <code>ge</code> function for Earth-like parameters</p><article class="docstring"><header><a class="docstring-binding" id="squirrel.metric.ge" href="#squirrel.metric.ge"><code>squirrel.metric.ge</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ge( X::RealVec )</code></pre><p>The <code>ge</code> function takes a point <code>X</code> in Cartesian Kerr-Schild  coordinates and calculates the components of the Kerr-Schild metric at  that point in a Kerr spacetime with relation between mass and angular  momentum roughly corresponding to the Earth value (<span>$a=738GM$</span>)</p></div></section></article><h2 id="Weak-field-metric"><a class="docs-heading-anchor" href="#Weak-field-metric">Weak field metric</a><a id="Weak-field-metric-1"></a><a class="docs-heading-anchor-permalink" href="#Weak-field-metric" title="Permalink"></a></h2><p>For solar system and terrestrial positioning, the weak field metric suffices. The weak field metric has the form:</p><p class="math-container">\[g_{\mu \nu} = \eta_{\mu \nu} - 2 \, V \, \delta_{\mu \nu},\]</p><p>where <span>$V$</span> is the gravitational potential.</p><h2 id="Gordon-metric"><a class="docs-heading-anchor" href="#Gordon-metric">Gordon metric</a><a id="Gordon-metric-1"></a><a class="docs-heading-anchor-permalink" href="#Gordon-metric" title="Permalink"></a></h2><p>To incorporate atmospheric and ionospheric effects, one uses the analogue Gordon metric, which takes the form (with <span>$g_{\mu \nu}$</span> being the gravitational metric):</p><p class="math-container">\[    \bar{g}_{\mu \nu} = g_{\mu \nu} + 
    \left(1-\frac{1}{n^2}\right) u_\mu u_\nu ,\]</p><p>The general Gordon metric is implemented in the following function:</p><article class="docstring"><header><a class="docstring-binding" id="squirrel.metric.gGordon" href="#squirrel.metric.gGordon"><code>squirrel.metric.gGordon</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">gGordon( X::RealVec , n::Function=nIR , gfunc::Function=giso , 
         U::RealVec=Float64[-1;0;0;0] )</code></pre><p>The function <code>gGordon</code> computes the Gordon metric. The argument <code>n</code> can be replaced with a user-supplied index of refraction function, the argument <code>gfunc</code> can be replaced with a user-supplied background metric, and the argument <code>U</code> can be replaced with a user-supplied fluid  four-velocity function.</p></div></section></article><p>In principle, the function implemented above can be used with any user defined index of refraction profile. However, for evaluation purposes, we implement some simplified index of refraction profiles in the following sections.</p><h3 id="Index-of-refraction-models"><a class="docs-heading-anchor" href="#Index-of-refraction-models">Index of refraction models</a><a id="Index-of-refraction-models-1"></a><a class="docs-heading-anchor-permalink" href="#Index-of-refraction-models" title="Permalink"></a></h3><p>The index of refraction is written in the following form:</p><p class="math-container">\[n = 1 + \Delta n_{\rm atm} + \Delta n_{\rm ion}\]</p><h4 id="Atmospheric-component"><a class="docs-heading-anchor" href="#Atmospheric-component">Atmospheric component</a><a id="Atmospheric-component-1"></a><a class="docs-heading-anchor-permalink" href="#Atmospheric-component" title="Permalink"></a></h4><p>The atmospheric component for the index of refraction is given here as a function of the height <span>$h$</span> from the surface of the Earth:</p><p class="math-container">\[\Delta n_{atm} = \frac{A_1}{B_1 + C_1 \left(h-H_1)\right)}
  + \frac{A_2}{B_2 + C_2 \left(h-H_2)\right)}\]</p><p>with the parameter choices:</p><p class="math-container">\[\begin{aligned}
    A_1 &amp;= -222.666    &amp;\qquad   A_2 &amp;= -253.499  \\
    B_1 &amp;= 99.0621     &amp;\qquad   B_2 &amp;= 112.757  \\
    C_1 &amp;= 0.157823 ~\text{km}^{-1}
        &amp;\qquad C_2 &amp;= 0.179669 ~\text{km}^{-1}\\
    H_1 &amp;= -7.1541  ~\text{km}
        &amp;\qquad   H_2 &amp;= -7.15654 ~\text{km}
\end{aligned}\]</p><p>The function <span>$\Delta n_{atm}$</span> is implemented in the following:</p><article class="docstring"><header><a class="docstring-binding" id="squirrel.metric.ΔnatmStd" href="#squirrel.metric.ΔnatmStd"><code>squirrel.metric.ΔnatmStd</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ΔnatmStd( h::Real )</code></pre><p>The function <code>ΔnatmStd</code> is a profile for the atmospheric index of  of refraction obtained from the U. S. standard atmosphere data. The argument <code>h</code> is height from the Earth&#39;s surface in km.</p></div></section></article><h4 id="Ionospheric-component"><a class="docs-heading-anchor" href="#Ionospheric-component">Ionospheric component</a><a id="Ionospheric-component-1"></a><a class="docs-heading-anchor-permalink" href="#Ionospheric-component" title="Permalink"></a></h4><p>The ionospheric component index of refraction is given by the following:</p><p class="math-container">\[\begin{aligned}
    \Delta n_{ion} \approx 
              \left(4.024 \times 10^{-17}\right) [N_e/\text{m}^{-3}]
\end{aligned}\]</p><p>where the electron density is given by:</p><p class="math-container">\[\begin{aligned}
    N_e :=&amp; \biggl[\alpha_D \, \tilde Ep(h,h_D,b_D)
          + \alpha_E \, \tilde Ep(h,h_E,b_E) 
          + \alpha_F \, \tilde Ep(h,h_F,b_F)\biggr],
\end{aligned}\]</p><p>with the parameter choices:</p><p class="math-container">\[\begin{aligned}
    \alpha_D &amp;= 10^{12}~\text{m}^{-3}
                   &amp;\quad   h_D &amp;=  75~\text{km}
                   &amp;\quad   b_D &amp;=   5~\text{km} \\
    \alpha_E &amp;= 2.5 \times 10^{11}~\text{m}^{-3}
                   &amp;\quad   h_E &amp;= 130~\text{km}
                   &amp;\quad   b_E &amp;=  30~\text{km} \\
    \alpha_F &amp;= 10^{11}~\text{m}^{-3}
                   &amp;\quad   h_F &amp;= 300~\text{km}
                   &amp;\quad   b_F &amp;=  50~\text{km} .
\end{aligned}\]</p><p>The function <span>$\tilde Ep(h,h_E,b_E)$</span> is the pseudo-Epstein function:</p><p class="math-container">\[\begin{aligned}
    \tilde Ep(h,h_c,B) := &amp;\frac{1}{16}
    \biggl\{
      \left[1+\left(\tfrac{h-h_c}{2 B}\right)^2\right]^{-1}
      +\left[1+\left(\tfrac{h-h_c}{4 B}\right)^2\right]^{-2}
      +\left[1+\left(\tfrac{h-h_c}{6 B}\right)^2\right]^{-3}
      +\left[1+\left(\tfrac{h-h_c}{7 B}\right)^2\right]^{-4}
      \biggr\}^2,
\end{aligned}\]</p><p>defined as:</p><article class="docstring"><header><a class="docstring-binding" id="squirrel.metric.pEp" href="#squirrel.metric.pEp"><code>squirrel.metric.pEp</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">pEp( h , hc , B , Nmax )</code></pre><p>The function <code>pEp</code> implements the pseudo-Epstein line shape function used to approximate the Epstein function used to construct the  ionospheric electron density profiles.</p></div></section></article><p>The ionospheric index of refraction, also written in terms of the height <span>$h$</span> from the surface of the Earth, is implemented in the following: </p><article class="docstring"><header><a class="docstring-binding" id="squirrel.metric.Δnios" href="#squirrel.metric.Δnios"><code>squirrel.metric.Δnios</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Δnios( h::Real , θ::Real , ϕ::Real )</code></pre><p>The function <code>Δnios</code> provides a crude model for the ionospheric electron density profile. The variable <code>h</code> represents height from the Earth&#39;s surface in units of km.</p></div></section></article><p>The unperturbed total index of refraction <span>$\Delta n_{\rm tot} = \Delta n_{\rm atm} + \Delta n_{\rm ion}$</span> is given in the following (in surface-adapted coordinates):</p><article class="docstring"><header><a class="docstring-binding" id="squirrel.metric.Δntot" href="#squirrel.metric.Δntot"><code>squirrel.metric.Δntot</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Δntot( h::Real , θ::Real , ϕ::Real )</code></pre><p>The function <code>Δntot</code> is the total index of refraction profile, which is a sum of atmospheric and ionospheric index of refraction profiles.  The variable <code>h</code> represents height from the Earth&#39;s surface in units of  km.</p></div></section></article><h4 id="Perturbation-models"><a class="docs-heading-anchor" href="#Perturbation-models">Perturbation models</a><a id="Perturbation-models-1"></a><a class="docs-heading-anchor-permalink" href="#Perturbation-models" title="Permalink"></a></h4><p>To model uncertainties in the index of refraction profile, perturbations of the following form are introduced (also in surface-adapted coordinates):</p><p class="math-container">\[\begin{aligned}
    \Delta n_{\rm pert} &amp;= \Delta n_{\rm atm} \left(1
                 + \delta_1 \, \tilde p_1(h) \right) \\
    &amp; \qquad 
    + \Delta n_{\rm ion} \left(1 + \delta_2 \, \tilde  p_2(h)\right),
\end{aligned}\]</p><p>and implemented in the following.</p><article class="docstring"><header><a class="docstring-binding" id="squirrel.metric.Δntp" href="#squirrel.metric.Δntp"><code>squirrel.metric.Δntp</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Δntp( h::Real , θ::Real , ϕ::Real , δ1::Real=0.001
           , δ2::Real=0.010 , Patm::Function=h-&gt;1.0
           , Pion::Function=h-&gt;1.0 )</code></pre><p>The function <code>Δntp</code> adds the perturbations provided in the perturbation model to the atmospheric and ionospheric profiles defined earlier.</p></div></section></article><p>The respective perturbation profile function <span>$p_A$</span> and line shape function <span>$Ls$</span> are defined:</p><p class="math-container">\[\tilde p_A(h) = \sum_{i} \alpha_i \tilde Ls(h,h_{0,i},\sigma_i)\]</p><article class="docstring"><header><a class="docstring-binding" id="squirrel.metric.P" href="#squirrel.metric.P"><code>squirrel.metric.P</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">P( h::Real , h0::RealVec , σ::RealVec )</code></pre><p>The function <code>P</code> constructs the perturbation model, which consists of a sum of line shape functions <code>LSF</code>, with the parameters provided in the vector arguments <code>h0</code> and <code>σ</code>.</p></div></section></article><p class="math-container">\[Ls(h,h_{0},\sigma) =  \frac{\sigma^2}{\sigma^2 
                      + (h-h_0)^2} \frac{\sigma^4}
                        {\sigma^4 + (h-h_0)^4}\]</p><article class="docstring"><header><a class="docstring-binding" id="squirrel.metric.LSF" href="#squirrel.metric.LSF"><code>squirrel.metric.LSF</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">LSF( x , xo , σ )</code></pre><p>The function <code>LSF</code> implements a line shape function employed in the perturbation models; it has a faster falloff than the Lorentzian.</p></div></section></article><p>The parameters <span>$h_i$</span> and  <span>$\sigma_i$</span> are fed into the perturbation profile functions as vectors.</p><h4 id="Conversion-functions"><a class="docs-heading-anchor" href="#Conversion-functions">Conversion functions</a><a id="Conversion-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Conversion-functions" title="Permalink"></a></h4><p>Index of refraction functions are converted from surface-adapted coordinates to spherical coordinates with the following function:</p><article class="docstring"><header><a class="docstring-binding" id="squirrel.metric.nIRs" href="#squirrel.metric.nIRs"><code>squirrel.metric.nIRs</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">nIRs( RE::Real , r::Real , θ::Real , ϕ::Real , Δnf::Function )</code></pre><p>The function <code>nIRs</code> computes the index of refraction in spherical coordinates from the index of refraction profile function <code>Δnf</code> in spherical coordinates. </p></div></section></article><p>Finally, the index of refraction functions are converted to Cartesian coordinates with the following function:</p><article class="docstring"><header><a class="docstring-binding" id="squirrel.metric.nIR" href="#squirrel.metric.nIR"><code>squirrel.metric.nIR</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">nIR( X::RealVec , Δnf::Function=Δntot )</code></pre><p>The function <code>nIR</code> computes the index of refraction in Cartesian coordinates; the profile is anchored to the WGS84 ellipsoid defined by the <code>rell</code> function.</p></div></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="index.html">« Home</a><a class="docs-footer-nextpage" href="geodesics.html">Geodesic solver »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.10 on <span class="colophon-date" title="Wednesday 5 January 2022 22:10">Wednesday 5 January 2022</span>. Using Julia version 1.6.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
