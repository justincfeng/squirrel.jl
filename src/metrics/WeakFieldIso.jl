#-----------------------------------------------------------------------
#   POTENTIAL FUNCTIONS
#-----------------------------------------------------------------------

#-----------------------------------------------------------------------
#   WGS84 Earth reference potential function
#-----------------------------------------------------------------------
function Vpot( X::RealVec , GM::Real=1 , J2::Real=1.0826300e-3 
    , a::Real=1.438127773656399e9 )
tpfl=typeof(X[1])
rs = dot(X[2:4],X[2:4])
return -( GM/sqrt(rs) )*( tpfl(1) - J2*((a)^2/rs)*Pl(cθ(X),2) )
end     #---------------------------------------------------------------

#-----------------------------------------------------------------------
#   WGS84 Earth reference ellipsoid radius
#-----------------------------------------------------------------------
function rell( x::RealVec , a::Real=1.438127773656399e9 
, b::Real=1.433306003519573e9 )
tpfl=typeof(x[1])
rs = dot(x,x)
return tpfl(a*b)/sqrt( b^2 + (a - b)*(a + b)*(x[3]^2)/rs )
end     #---------------------------------------------------------------

#-----------------------------------------------------------------------
#   WGS84 Earth reference ellipsoid rescale factor
#-----------------------------------------------------------------------
function rellsc( x::RealVec , a::Real=1.438127773656399e9 
, b::Real=1.433306003519573e9 )
tpfl=typeof(x[1])
rs = dot(x,x)
return tpfl(b)/sqrt( b^2 + (a - b)*(a + b)*(x[3]^2)/rs )
end     #---------------------------------------------------------------

#-----------------------------------------------------------------------
#   ISOTROPIC METRIC COMPONENTS
#-----------------------------------------------------------------------
function giso( X::RealVec )
tpfl=typeof(X[1])

V = Vpot( X, tpfl(1) , tpfl(1.0826300e-3) 
, tpfl(1.438127773656399e9) )

return ημν(tpfl) + V*δμν(tpfl)
end     #---------------------------------------------------------------

#-----------------------------------------------------------------------